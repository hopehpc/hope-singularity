Bootstrap: library
From: ubuntu:16.04

%setup
	# Working directory where installation scripts and other files will be stored
	mkdir ${SINGULARITY_ROOTFS}/singularity-build

%files
	# Copy files from the host machine
	scripts/install-python.sh /singularity-build/install-python.sh		# Python installation script
	scripts/install-packages.sh /singularity-build/install-packages.sh	# Package installation script
	packages/base.txt /singularity-build/base.txt				# Packages to install

%post
	WORKDIR=/singularity-build	# Working directory in container created during %setup
	PY2VER=2.7.16			# Python 2 version
	PY3VER=3.7.3			# Python 3 version

	# Install basic packages
	apt-get update && apt-get -y upgrade
	apt-get install -y build-essential software-properties-common \
		curl htop man unzip wget gcc \
		python3-setuptools
	
	cd $WORKDIR

	# Run Python installation script
	bash install-python.sh $PY2VER $PY3VER $WORKDIR

	# Run Python package installation script
	bash install-packages.sh base.txt

%runscript
	python3	$@	# Default to Python 3 and accept command-line arguments
